# Design Notes: Semantic Retrieval

## Core Principles

- **Backend agnostic**: no hard dependency on vector stores.
- **Composable scoring**: support BM25-only, vector-only, and hybrid.
- **Deterministic ranking**: stable tie-breakers for reproducible results.
- **Separation of concerns**: indexing vs searching are distinct interfaces.

## Indexing

- Tool documents include namespace, name, description, tags, and schema hints.
- Embeddings are generated by a caller-supplied `Embedder`.

## Querying

- Query text is embedded and compared to tool documents.
- Optional filters (namespace, tags, category) are applied post-score.

## Integration Points

- `toolindex`: source of tool documents.
- `toolsearch`: optional BM25 implementation for baseline ranking.
- `metatools-mcp`: provider layer can call semantic search.
